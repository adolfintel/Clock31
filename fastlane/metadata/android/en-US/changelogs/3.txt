* Fixed possible crash during widget creation/initialization
* Improved permissions-related code
* Removed some unnecessary leftover code
